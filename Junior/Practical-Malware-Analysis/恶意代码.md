## 恶意代码 2023FALL

*by ErwinZhou*

### 总体评价

最恶心的就是平时这个课的作业，足足有差不多13次实验报告（课本+R77的两次，最后还差点说留一个机器学习识别恶意代码的大作业？），每次内容巨多，而且最开始还一周一个实验报告，最后偶尔变成两周一个。

对于大三上的网安人来说，不值得花这么多时间，每周认真地做它的实验报告，期末也不会涉及太多内容。毕竟这学期还有编译，os，计网这些大课。。。

不过该课程是讲授Windows相关机制的内容最多的课程之一，对于了解一些Windows相关知识还是挺有用的。病毒的相关知识只是浅尝辄止，有一个大概的认识，王志老师也人很好。

平时实验分数（30%）+考勤（20%）。实验分为实验报告和一次实验展示（10分展示，尽可能做一些探索的工作，邓老师会给高一点可能）考勤记得一定要留个朋友去实验课，后面老师有时候直接就说雨课堂进入的就不计分了。。。必须扫码进，还有一次直接线下签到了但没通知所有人。

期末复习王志老师之前不知道是不是吓唬我们说期末平均分60多分，去年好像让手写IDA Python，今年难度没有那么高，所以不要被吓到。期末复习时候可以考虑集中两天速通，最后狂背然后去考，把大头留给必修课。

### 考试

#### 选择（2分一个）

涉及到沙盒的缺点等。是每个选项混合很多，考的比较明显，认真看过了应该都没啥问题，不是非常细致。异或计算(给定A和a的起始ASCII码，挂起进程)。简单的Yara。

#### 多选（2分一个）

涉及到虚拟机的优势，还有一个印象很深注册表操作的API，有的后面有Ex，有的没有。具体而言是Get没有Ex等任何后缀，Set和Open应该是有Ex，但没有W。有二选和三选，没有四选应该。

#### 简答（5分一个）

恶意代码分析的目的

击键记录器的三种实现方式（内核1+用户2）

内核态与用户态代码区别

简单加密算法有哪三个及原理+数据识别方法

写一个Yara。涉及到十六进制表示$a={AA ...}，文件大小，PE文件判断还有一个和课后题很类似的for i in (1..#a) : (@a[i]<多少多少)

进程挂起和进程注入的原理

五个驻留化技术方法及原理

IDS,IPS,DNS沉洞，Web和Email Proxy的原理。和DPI相关

#### 大题（一个15分）

进程注入（DLL注入）的代码。问你注入的进程是svchost，为什么注入他？注入流程等。大部分代码都有。分析也很简单

SSDT和IDT的原理，以及实现挂钩原理。+一个Rootkit定位NtCreateFile（挂钩函数）和对应Rootkit模块【比较简单其实，稍微看眼实验报告就行，就找在对应地址范围内的就ok】

